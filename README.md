# windpywrapper
v0.5 / 对Wind Python API进行封装，拓展功能，简单易用

> 此工具包仅用于日常研究，请勿用于任何商业用途

> 如有任何建议或意见，欢迎留言

### 支持：
1. 多代码、多字段同时查询
2. 超大数据单次查询
3. 全面统一使用pandas DataFrame数据格式以及pandas Timestamp时间格式
4. 支持原始API的全部可选参数

### 开始使用：
包含datafeed_wind，datetools和utils三个文件

 - datafeed_wind：读取时间序列数据、面板数据
 - datetools：处理时间数据
 - utils：支持运行的工具函数

可使用如下语句调用：
``` python
from datafeed_wind import *
from datetools import *
```

### 数据功能：

 - **时间序列查询 wind_series，wind_edb**
   功能说明：
``` python
# -------------------------------------------------
# 单代码+多字段查询（以下代码实现功能相同）
# 查询沪深300指数收盘价和成交量
# 可使用字符串或列表作为输入参数
wind_series("000300.SH", "CLOSE, VOLUME", "2020-01-01", "2020-09-30")
wind_series("000300.sh", ["close", "VOLUME"], "2020-01-01", "2020-09-30")
# 内置常用时间宏，CYB=current year begin
wind_series("000300.sh", "CLOSE, VOLUME", CYB, "2020-09-30")

# -------------------------------------------------
# 多代码+多字段查询（以下代码实现功能相同）
# 查询中证500指数和中证800指数的开盘价和收盘价
wind_series(["000905.sh", "000906.sh"], "open, close", "2020-01-01", "2020-09-30")

# -------------------------------------------------
# 宏观经济数据库查询（以下代码实现功能相同）
# 查询工业增加值当月同比和银行间同业拆借7天加权利率
# 支持Wind内置的时间宏
# 查询不同发布频率的宏观经济数据时，低频数据自动通过线性插值对齐高频数据
wind_series("M0000545, M0041664", "EDB", "-2Y", TODAY)
wind_edb("M0000545, M0041664", "-2Y", TODAY)
```

 - **指数/板块成分 wind_components**
   功能说明：

```python
# -------------------------------------------------
# 指数成分查询
# 默认查询最近交易日数据
wind_components("000300.sh") 
# 可指定查询日，LME为内置时间常量，=last month end
wind_components("000906.sh", LME) 
# 支持查询证券代码及名称，返回字典格式
wind_components("000906.sh", show_name=True) 

# -------------------------------------------------
# 板块成分查询
# 查询全部中国公募基金的代码
wind_component("a201010700000000", show_name=True)
```

- **面板数据查询 wind_panel**
   功能说明：
```python
# -------------------------------------------------
# 板块成分查询
# 查询全部中国公募基金的一级分类和二级分类
fund_code = wind_component("a201010700000000") # 中国公募基金（净值）
fields = [
    "fund_firstinvesttype", # 基金类别-证监会规则
    "fund_investtype2", # 基金类别-Wind规则：证监会规则下的细类（二级：fundtype=2）
    ]
fund_class = wind_panel(fund_all_wcode, fields, tradedate=TODAY, fundtype=2)
```

### 时间功能：
 - **交易日处理 td, td_next, td_is, td_offset, td_count**
   功能说明：
``` python
# -------------------------------------------------
# 返回最近交易日
td() # 默认为今日
td("2020-09-09")

# -------------------------------------------------
# 返回下一个交易日
td_next() # 默认为今日
td_next("2010-08-08")

# -------------------------------------------------
# 判断该日期是否为交易日
td_is() # 默认为今日
td_is("2020-01-01")

# 返回向前或向后指定距离的交易日
td_offset("-3y", "2020-09-09") # 2020年9月9日向前3年的最近交易日
td_offset("1M", YESTERDAY) # 昨天向后1月的最近交易日，YESTERDAY为内置时间常量

# 计算两个时间点之间的天数
td_count("-1Y", LQE) # 一年前至上季度末之间的交易日天数
td_count("2020-03-03", CMB, days="alldays") # 2020年3月3日至本月初的日历日天数
```

**使用注意事项：**
1. 使用此工具包需先开通Wind API权限
2. 此工具包不适合用于高频数据处理
